# 메모리

- 목차
    1. 메모리의 종류
        1. 레지스터
        2. 캐시
        3. 메인메모리
        4. 보조저장장치
    2. 메모리 주소
    3. 32bit / 64bit
    4. 물리주소 / 논리주소
    5. 절대주소 / 상대주소



## 메모리의 종류

### 레지스터

레지스터는 가장 빠른 기억장소로 CPU내에 존재하고 있다.

컴퓨터에 전원이 꺼지면 데이터가 사라지기 때문에 휘발성 메모리라고 부른다.

CPU를 구분할 때 32bit와 64bit는 레지스터의 크기를 말한다.

CPU는 계산을 할때 메인메모리에 있는 값을 레지스터로 가져와 계산을 한다.

계산 결과는 다시 메인 메모리에 저장시킨다.

### 캐시

레지스터와 메인메모리 사이에는 캐시라는 휘발성 메모리가 있다.

레지스터는 CPU가 사용하는 메모리로 매우 빠르고 메인메모리는 그에 비해서 너무 느리다.

메인 메모리에 있는 값을 레지스터로 옮기려면 오래 걸리기 때문에 필요할 것으로 예상되는 값을 미리 가져온다.

그 미리가져온 데이터를 저장하는곳이 캐시이다.

캐시는 성능의 이유로 여러개는 둔다.(L1, L2 이런식으로)

### 메인메모리

메인메모리는 실제 운영체제와 다른 프로세스들이 올라가는 공간이다.

전원이 공급되지 않으면 데이터가 지워지기 때문에 휘발성 메모리이다.

하드디스크나 SSD보다 속도는 빠르지만 가격에 비싸기 때문에 데이터를 저장하기 보다는 실행중인 프로그램만 올라간다.

### 보조저장장치(HDD, SSD)

앞서 설명한 메모리들은 휘발성 메모리이고 가격이 비싸서 저장하기 어려웠다.

그래서 가격이 저렴하고 전원 공급이 멈춰도 데이터가 지워지지 않는 비휘발성 메모리를 만들었다.

## 메모리 주소

오늘날 컴퓨터는 폰 노이만 구조로 되어있고 폰 노이만 구조는 모든 프로그램을 메모리에 올려서 실행시킨다.

유니프로그래밍 환경에서는 하나의 프로그램만 메모리에 올라오기 때문에 메모리 관리가 어렵지 않았다.

하지만 멀티 프로세스 환경에서는 여러 프로그램이 올라와 복잡하고 어려워졌다.

운영체제는 메모리를 관리하기 위해서 1바이트(8bit) 크기로 구역을 나누고 숫자를 매긴다.

이 숫자를 주소라고 부른다.

## 32bit / 64bit

32bit cpu는 레지스터 크기가 32bit이고 cpu가 처리하는 ALU(산술연산장치)도 데이터가 이동하는 버스도 32bit이다.

또한 cpu가 다룰 수 있는 메모리도 2^32으로 4GB이다.

64bit cpu는 레지스터 크기와 ALU, 버스의 크기도 64bit이다.

다룰 수 있는 메모리의 크기도 2^64으로 거의 무한대에 가깝다.

## 물리주소 / 논리주소

메모리를 컴퓨터에 연결하면 0x0번지부터 시작하는 주소공간이 있는데 이를 "물리 주소 공간"이라고 한다.

이와 다르게 사용자 관점에서 바라본 주소공간은 "논리 주소 공간"이라고 부른다.

사용자는 물리 주소를 몰라도 논리 주소로 물리 주소에 접근할 수 있다.

메모리에는 운영체제와 수 많은 프로세스가 올라온다.

운영체제는 특별하기 때문에 운영체제를 위한 공간은 따로 마련해둔다.

사용자가 운영체제에 직접적으로 접근할 수 없도록 하드웨어적으로 운영체제 공간과 사용자 공간을 나누는 경계 레지스터를 만들었다.

경계 레지스터는 cpu내에 존재하는 레지스터로 메모리 관리자(Memory Management Unit)가 사용자 프로세스가 경계 레지스터의 값을 벗어났는지 검사하고 만약 벗어났다면 그 프로세스를 종료 시킨다.

## 절대주소 / 상대주소

메모리에는 절대주소와 상대주소라는 개념이 있다.

개발자는 프로그램을 만들때 프로그램이 실행될 주소를 신경쓰지 않고 개발한다.

이는 컴파일러가 컴파일을 할 때 메모리 0번지에서 실행한다고 "가정"하기 때문이다.

개발자의 프로그램을 실행시켜 메모리의 사용자 공간 0x4000 번지에 올라왔다고 가정해보자.

컴파일러는 0x0 번지라고 가정해서 프로그램을 만들었고 이는 "상대주소"이다.

실제 프로그램이 올라간 주소는 0x4000 번지 인데 이는 메모리 관리자가 바라본 "절대주소"이다.

사용자가 바라본 주소인 "상대주소"는 "논리 주소 공간"이라고 부르고 메모리 관리자가 바라본 주소인 "절대주소"는 "물리 주소 공간"이라고 부른다.

